<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>mail_ntlm.pkb</title><link rel="stylesheet" type="text/css" href="../../../../styles/main.css" /><script type="text/javascript" src="../../../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.1.1 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body"></a><a name="Topic817"></a><div class="CTopic TClass LSQL first">
 <div class="CTitle"><span class="Qualifier">Output Modules.&#8203;PIT_MAIL.</span>&#8203;MAIL_NTLM Body</div>
 <div class="CBody"><p>Package to allow to authenticate to a NTLM SMTP server</p><div class="CHeading">Disclaimer</div><p>This package is a PL/SQL port from the Ntml.java, distributed under <a href="https://glassfish.dev.java.net/public/CDDL+GPL_1_1.html" target="_top">GNU General Public License Version 2 only (&quot;GPL&quot;) or the Common Development and Distribution License(&quot;CDDL&quot;) 1.0</a>.&nbsp; Ntlm.java is part of javamail, available at <a href="http://kenai.com/projects/javamail" target="_top">http://&#8203;kenai&#8203;.com&#8203;/projects&#8203;/javamail</a> Authors: Michael McMahon and Bill Shannon Port made by Javier Martin-Ortega, under GPL v2</p><div class="CHeading">Author</div><p>Juergen Sieben, ConDeS GmbH</p></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.Private_Constants"></a><a name="Topic818"></a><div class="CTopic TGroup LSQL">
 <div class="CTitle">Private Constants</div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.Crypt-related_constants"></a><a name="Topic819"></a><div class="CTopic TConstant LSQL">
 <div class="CTitle">Crypt-related constants</div>
 <div class="CBody"><table class="CDefinitionList"><tr><td class="CDLEntry"><a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.C_CRYPT_TYPE"></a><a name="Topic820"></a>C_CRYPT_TYPE</td><td class="CDLDefinition"><p>Encryption method required for NTLM</p></td></tr><tr><td class="CDLEntry"><a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.C_MAGIC"></a><a name="Topic821"></a>C_MAGIC</td><td class="CDLDefinition"><p>Salt information</p></td></tr><tr><td class="CDLEntry"><a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.C_NTLM"></a><a name="Topic822"></a>C_NTLM</td><td class="CDLDefinition"><p>Name of the authentication method NTLM</p></td></tr></table></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.Helper_Methods"></a><a name="Topic823"></a><div class="CTopic TGroup LSQL">
 <div class="CTitle">Helper Methods</div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.create_des_key"></a><a name="Topic824"></a><div class="CTopic TFunction LSQL">
 <div class="CTitle">create_des_key</div>
 <div id="NDPrototype824" class="NDPrototype WideForm"><div class="PSection PParameterSection PascalStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> create_des_key(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">p_key&nbsp;</td><td class="PType last"><span class="SHKeyword">varchar</span>,</td></tr><tr><td class="PName first">p_offset&nbsp;</td><td class="PType last"><span class="SHKeyword">number</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div><div class="PSection PPlainSection"><span class="SHKeyword">return</span> <span class="SHKeyword">varchar2</span></div></div>
 <div class="CBody"><p>Method to create a DES key based on the input parameters</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">p_key<div class="CDLParameterType"><span class="SHKeyword">varchar</span></div></td><td class="CDLDefinition"><p>Key</p></td></tr><tr><td class="CDLEntry">p_offset<div class="CDLParameterType"><span class="SHKeyword">number</span></div></td><td class="CDLDefinition"><p>Offset value for the key</p></td></tr></table><div class="CHeading">Returns</div><p>DES key</p></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.add_parity_bit"></a><a name="Topic825"></a><div class="CTopic TFunction LSQL">
 <div class="CTitle">add_parity_bit</div>
 <div id="NDPrototype825" class="NDPrototype WideForm"><div class="PSection PParameterSection PascalStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> add_parity_bit(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">p_des_key&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div><div class="PSection PPlainSection"><span class="SHKeyword">return</span> <span class="SHKeyword">varchar2</span></div></div>
 <div class="CBody"><p>Adds a parity bit at the end of every byte</p><div class="CHeading">Parameter</div><table class="CDefinitionList"><tr><td class="CDLEntry">p_des_key<div class="CDLParameterType"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>DES key</p></td></tr></table><div class="CHeading">Returns</div><p>DES key with the parity bits added</p></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.generate_secret"></a><a name="Topic826"></a><div class="CTopic TFunction LSQL">
 <div class="CTitle">generate_secret</div>
 <div id="NDPrototype826" class="NDPrototype WideForm"><div class="PSection PParameterSection PascalStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> generate_secret(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">p_des_key&nbsp;</td><td class="PType last"><span class="SHKeyword">varchar2</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div><div class="PSection PPlainSection"><span class="SHKeyword">return</span> <span class="SHKeyword">varchar2</span></div></div>
 <div class="CBody"><p>Generates a secret from the DES key</p><div class="CHeading">Parameter</div><table class="CDefinitionList"><tr><td class="CDLEntry">p_des_key<div class="CDLParameterType"><span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>DES key</p></td></tr></table><div class="CHeading">Returns</div><p>Secret</p></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.get_utf_little_unmarked"></a><a name="Topic827"></a><div class="CTopic TFunction LSQL">
 <div class="CTitle">get_utf_little_unmarked</div>
 <div id="NDPrototype827" class="NDPrototype WideForm"><div class="PSection PParameterSection PascalStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> get_utf_little_unmarked(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">p_text&nbsp;</td><td class="PType last"><span class="SHKeyword">varchar2</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div><div class="PSection PPlainSection"><span class="SHKeyword">return</span> <span class="SHKeyword">varchar2</span></div></div>
 <div class="CBody"><p>Converts &lt;P_TEXT&gt; to Unicode by simply adding a 00 byte after every original text's byte</p><div class="CHeading">Parameter</div><table class="CDefinitionList"><tr><td class="CDLEntry">p_text<div class="CDLParameterType"><span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>Text to convert</p></td></tr></table><div class="CHeading">Returns</div><p>Unicode encoded string</p></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.length_in_two_bytes"></a><a name="Topic828"></a><div class="CTopic TFunction LSQL">
 <div class="CTitle">length_in_two_bytes</div>
 <div id="NDPrototype828" class="NDPrototype WideForm"><div class="PSection PParameterSection PascalStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> length_in_two_bytes(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">p_data&nbsp;</td><td class="PType last"><span class="SHKeyword">number</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div><div class="PSection PPlainSection"><span class="SHKeyword">return</span> <span class="SHKeyword">varchar2</span></div></div>
 <div class="CBody"><p>Returns the length passed in as &lt;P_DATA&gt; in a two byte representation</p><div class="CHeading">Parameter</div><table class="CDefinitionList"><tr><td class="CDLEntry">p_data<div class="CDLParameterType"><span class="SHKeyword">number</span></div></td><td class="CDLDefinition"><p>Length to convert</p></td></tr></table><div class="CHeading">Returns</div><p>Length as a two byte string</p></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.calc_response"></a><a name="Topic829"></a><div class="CTopic TFunction LSQL">
 <div class="CTitle">calc_response</div>
 <div id="NDPrototype829" class="NDPrototype WideForm"><div class="PSection PParameterSection PascalStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> calc_response(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">p_key&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span>,</td></tr><tr><td class="PName first">p_text&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div><div class="PSection PPlainSection"><span class="SHKeyword">return</span> <span class="SHKeyword">varchar2</span></div></div>
 <div class="CBody"><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">p_key<div class="CDLParameterType"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>Key</p></td></tr><tr><td class="CDLEntry">p_test</td><td class="CDLDefinition"><p>Textto encrypt</p></td></tr></table><div class="CHeading">Returns</div><p>Encrypted version of &lt;P_TEXT&gt;</p></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.calc_lm_hash"></a><a name="Topic830"></a><div class="CTopic TFunction LSQL">
 <div class="CTitle">calc_lm_hash</div>
 <div id="NDPrototype830" class="NDPrototype WideForm"><div class="PSection PParameterSection PascalStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> calc_lm_hash (</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">p_password&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div><div class="PSection PPlainSection"><span class="SHKeyword">return</span> <span class="SHKeyword">varchar2</span></div></div>
 <div class="CBody"><div class="CHeading">Parameter</div><table class="CDefinitionList"><tr><td class="CDLEntry">p_password<div class="CDLParameterType"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>Password to hash</p></td></tr></table><div class="CHeading">Returns</div><p>Encrypted password for LM</p></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.calc_nt_hash"></a><a name="Topic831"></a><div class="CTopic TFunction LSQL">
 <div class="CTitle">calc_nt_hash</div>
 <div id="NDPrototype831" class="NDPrototype WideForm"><div class="PSection PParameterSection PascalStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> calc_nt_hash(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">p_password&nbsp;</td><td class="PType last"><span class="SHKeyword">varchar2</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div><div class="PSection PPlainSection"><span class="SHKeyword">return</span> <span class="SHKeyword">varchar2</span></div></div>
 <div class="CBody"><div class="CHeading">Parameter</div><table class="CDefinitionList"><tr><td class="CDLEntry">p_password<div class="CDLParameterType"><span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>Password to hash</p></td></tr></table><div class="CHeading">Returns</div><p>Encrypted password for NT</p></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.generate_first_msg"></a><a name="Topic832"></a><div class="CTopic TFunction LSQL">
 <div class="CTitle">generate_first_msg</div>
 <div id="NDPrototype832" class="NDPrototype WideForm"><div class="PSection PParameterSection PascalStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> generate_first_msg(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">p_domain&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span>,</td></tr><tr><td class="PName first">p_host&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div><div class="PSection PPlainSection"><span class="SHKeyword">return</span> <span class="SHKeyword">varchar2</span></div></div>
 <div class="CBody"><p>Generates the initial message to authenticate</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">p_domain<div class="CDLParameterType"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>Domain of the mail server</p></td></tr><tr><td class="CDLEntry">p_host<div class="CDLParameterType"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>Name of the mail server</p></td></tr></table><div class="CHeading">Returns</div><p>Initial message</p></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.generate_second_msg"></a><a name="Topic833"></a><div class="CTopic TFunction LSQL">
 <div class="CTitle">generate_second_msg</div>
 <div id="NDPrototype833" class="NDPrototype WideForm"><div class="PSection PParameterSection PascalStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">function</span> generate_second_msg(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">p_first_reply&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span>,</td></tr><tr><td class="PName first">p_user&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span>,</td></tr><tr><td class="PName first">p_password&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span>,</td></tr><tr><td class="PName first">p_domain&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span>,</td></tr><tr><td class="PName first">p_host&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div><div class="PSection PPlainSection"><span class="SHKeyword">return</span> <span class="SHKeyword">varchar2</span></div></div>
 <div class="CBody"><p>Generates the initial message to authenticate</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">p_first_reply<div class="CDLParameterType"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>First reply of the server</p></td></tr><tr><td class="CDLEntry">p_user<div class="CDLParameterType"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>User name to authenticate</p></td></tr><tr><td class="CDLEntry">p_password<div class="CDLParameterType"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>Password of the user</p></td></tr><tr><td class="CDLEntry">p_domain<div class="CDLParameterType"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>Domain of the mail server</p></td></tr><tr><td class="CDLEntry">p_host<div class="CDLParameterType"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></div></td><td class="CDLDefinition"><p>Name of the mail server</p></td></tr></table><div class="CHeading">Returns</div><p>Second message</p></div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.Interface"></a><a name="Topic834"></a><div class="CTopic TGroup LSQL">
 <div class="CTitle">Interface</div>
</div>

<a name="Output_Modules.PIT_MAIL.MAIL_NTLM_Body.authenticate"></a><a name="Topic835"></a><div class="CTopic TFunction LSQL last">
 <div class="CTitle">authenticate</div>
 <div id="NDPrototype835" class="NDPrototype WideForm"><div class="PSection PParameterSection PascalStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">procedure</span> authenticate(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first">p_conn&nbsp;</td><td class="PType last"><span class="SHKeyword">in out nocopy</span> utl_smtp.connection,</td></tr><tr><td class="PName first">p_host&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span>,</td></tr><tr><td class="PName first">p_user_name&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span>,</td></tr><tr><td class="PName first">p_password&nbsp;</td><td class="PType last"><span class="SHKeyword">in</span> <span class="SHKeyword">varchar2</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>see: <a href="../../../../index.html#File:modules/pit_mail/packages/mail_ntlm.pks:Output_Modules.PIT_MAIL.MAIL_NTLM.authenticate" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,797);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MAIL_NTLM.authenticate</a></p></div>
</div>

</body></html>